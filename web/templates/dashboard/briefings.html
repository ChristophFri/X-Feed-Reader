{% extends "base.html" %}

{% block title %}Briefings â€” X Feed Reader{% endblock %}

{% block body %}
{% include "dashboard/_nav.html" %}

<main class="max-w-3xl mx-auto px-6 pt-24 pb-16">
  <div class="flex items-center justify-between mb-8">
    <div>
      <h1 class="text-2xl font-bold">Briefings</h1>
      <p class="text-surface-400 text-sm mt-1">{{ total }} briefing{{ 's' if total != 1 else '' }} total</p>
    </div>
  </div>

  {% if briefings %}
  <div class="space-y-3">
    {% for b in briefings %}
    <a href="/app/briefings/{{ b.id }}" class="block p-5 rounded-xl bg-surface-900/50 border border-surface-800/50 hover:border-surface-700 transition-colors">
      <div class="flex items-center justify-between mb-2">
        <span class="text-sm font-medium">{{ b.created_at.strftime('%B %d, %Y at %H:%M') }}</span>
        <div class="flex items-center gap-2">
          {% if b.delivered_email %}
          <span class="px-2 py-0.5 rounded text-xs bg-green-900/40 text-green-400 border border-green-800/40">Email</span>
          {% endif %}
          {% if b.delivered_telegram %}
          <span class="px-2 py-0.5 rounded text-xs bg-blue-900/40 text-blue-400 border border-blue-800/40">Telegram</span>
          {% endif %}
          {% if b.delivery_error %}
          <span class="px-2 py-0.5 rounded text-xs bg-red-900/40 text-red-400 border border-red-800/40">Error</span>
          {% endif %}
        </div>
      </div>
      <div class="text-surface-400 text-sm flex items-center gap-3">
        <span>{{ b.tweet_count }} tweets</span>
        <span class="w-1 h-1 rounded-full bg-surface-600"></span>
        <span>{{ b.llm_provider }}</span>
        <span class="w-1 h-1 rounded-full bg-surface-600"></span>
        <span>{{ b.prompt_preset }}</span>
      </div>
      <p class="text-surface-300 text-sm mt-2 line-clamp-2">{{ b.content[:200] }}{% if b.content|length > 200 %}...{% endif %}</p>
    </a>
    {% endfor %}
  </div>

  <!-- Pagination -->
  {% if total_pages > 1 %}
  <div class="flex items-center justify-center gap-2 mt-8">
    {% if page > 1 %}
    <a href="/app/briefings?page={{ page - 1 }}" class="px-3 py-1.5 rounded-lg bg-surface-800 text-sm text-surface-300 hover:text-white transition-colors">&larr; Previous</a>
    {% endif %}
    <span class="px-3 py-1.5 text-sm text-surface-400">Page {{ page }} of {{ total_pages }}</span>
    {% if page < total_pages %}
    <a href="/app/briefings?page={{ page + 1 }}" class="px-3 py-1.5 rounded-lg bg-surface-800 text-sm text-surface-300 hover:text-white transition-colors">Next &rarr;</a>
    {% endif %}
  </div>
  {% endif %}

  {% else %}
  <div class="text-center py-16 text-surface-500">
    <svg class="w-16 h-16 mx-auto mb-4 text-surface-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"/></svg>
    <p class="text-lg mb-2">No briefings yet</p>
    <p class="text-sm">Go to your <a href="/app/dashboard" class="text-brand-400 hover:text-brand-300">dashboard</a> and click "Run Now" to generate your first briefing.</p>
  </div>
  {% endif %}
</main>
{% endblock %}
